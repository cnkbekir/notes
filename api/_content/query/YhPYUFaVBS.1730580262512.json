[{"_path":"/statik-wordpress-sitesi","_dir":"","_draft":false,"_partial":false,"_locale":"","title":"Statik Wordpress Sitesi","description":"","id":"1","date":"2023-11-16","categories":["web"],"tags":["wordpress"],"cover":"","readingTime":{"text":"2 min read","minutes":1.315,"time":78900,"words":263},"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Kullanacağımız sistemler:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Wordpress"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"CloudFlare"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://wordpress.org/plugins/simply-static/","rel":["nofollow"]},"children":[{"type":"text","value":"Simply Static – WordPress plugin"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Github Actions"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Bash script"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Wordpress'te simply statik eklentisini kuruyoruz. Eklentinin Settings -> Deployment sayfasında Deployment Method olarak Local Directory seçiyoruz. PATH olarak /var/www/static/ girdim.\nBulunduğumuz domainle aynı yerde yayınlamayacağımız için Replacing URLs ayarlarında Relative Paths seçip / değerini giriyoruz.\nAdvanced ayarlar sayfasında da Force URL Replacements seçeneğini aktifleştiriyoruz."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Benim DNS ayarlarım CloudFlare'de. Sitemi Proxied seçeneğini kapatıp sadece DNS kaydı olarak tutuyorum. certbot ile sunucuda SSL ayarlıyorum."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Sunucuda dizini oluşturup eklentide Generate Static Files butonuna basarak işlemi başlatıyoruz.\nDebugging Mode ayarı var, onu aktifleştirebiliriz. Activity Log sayfasından işlemi takip edebiliyoruz."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Sunucuda /var/www/static/ dizinini GitHub'da bir repo açarak oraya yüklüyoruz.\nDeploy keys ile yapmak için: "},{"type":"element","tag":"a","props":{"href":"https://dylancastillo.co/how-to-use-github-deploy-keys/","rel":["nofollow"]},"children":[{"type":"text","value":"How to Use GitHub Deploy Keys (dylancastillo.co)"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"İlk sefer dışında buraya girmeye gerek kalmasın diye güncellemeleri push'layan bir bash script'i root hesabındayken crontab'a ekliyorum."}]},{"type":"element","tag":"pre","props":{"code":"* * * * * [ $(find /var/www/ufkayolculuk_wp/index.html -type f | wc -l) -gt 0 ];then /var/www/static.sh && cd /var/www/static && git add . && git commit -m \"Automatic Commit\" && git push; fi\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"* * * * * [ $(find /var/www/ufkayolculuk_wp/index.html -type f | wc -l) -gt 0 ];then /var/www/static.sh && cd /var/www/static && git add . && git commit -m \"Automatic Commit\" && git push; fi\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Baştaki if komutunu bir kaç denemeden sonra farkederek ekledim. Statik dosyaların generate işlemi sırasında index.html olmadığı için bu sorgu sayesinde o işlemin bitmesini beklemiş oluyorum."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"GitHub deploy keys kullanmazsam Git işlemleri yapılabilmesi için şu komutu kullanıp bir defa manuel git commit ve push işlemini yapıyorum"}]},{"type":"element","tag":"pre","props":{"code":"git config --global credential.helper store\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"git config --global credential.helper store\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Cron job ile çalıştırılan /var/www/static.sh dosyası:"}]},{"type":"element","tag":"pre","props":{"code":"#!/bin/sh\n/usr/bin/find /var/www/static/ -maxdepth 3 -type f -name 'index.html' -exec /usr/bin/sed -i 's+<\\\\/+</+g' {} \\;\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"#!/bin/sh\n/usr/bin/find /var/www/static/ -maxdepth 3 -type f -name 'index.html' -exec /usr/bin/sed -i 's+<\\\\/+</+g' {} \\;\n"}]}]},{"type":"element","tag":"pre","props":{"code":"chmod +x /var/www/static.sh\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"chmod +x /var/www/static.sh\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"CloudFlare Pages'ta yeni bir kayıt oluşturuyoruz, GitHub'daki repomuza bağlıyoruz. Statik dosyalar olduğu için build ayarlarında değişiklik yapmadan yayına alıyoruz."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Artık GitHub'da her değişiklikte sitemiz güncellenicek. Ayrıca CloudFlare Pages'taki pages.dev uzantılı adresi Custom Domains sayfasından kendi alan adınıza bağlayabiliyorsunuz."}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"content:statik-wordpress-sitesi.md","_source":"content","_file":"statik-wordpress-sitesi.md","_stem":"statik-wordpress-sitesi","_extension":"md"}]